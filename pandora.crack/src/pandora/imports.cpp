#include <hooks/hooks.h>
#include <pandora/pandora.h>

#define FIX_IMPORT(offset, moduleName, procName) *(FARPROC*)ImageBase(offset) = GetProcAddress(LoadLibraryA(moduleName), procName)

namespace Pandora
{
	VOID SetupImports()
	{
		FIX_IMPORT(0x5F6000, "advapi32.dll", "CryptAcquireContextA");
		FIX_IMPORT(0x5F6004, "advapi32.dll", "CryptReleaseContext");
		FIX_IMPORT(0x5F6008, "advapi32.dll", "CryptGenRandom");
		FIX_IMPORT(0x5F6010, "crypt32.dll", "CertOpenStore");
		FIX_IMPORT(0x5F6014, "crypt32.dll", "CertEnumCertificatesInStore");
		FIX_IMPORT(0x5F6018, "crypt32.dll", "CertCloseStore");
		FIX_IMPORT(0x5F601C, "crypt32.dll", "CertFreeCRLContext");
		FIX_IMPORT(0x5F6024, "gdi32.dll", "AddFontMemResourceEx");
		FIX_IMPORT(0x5F602C, "kernel32.dll", "GetTickCount");
		FIX_IMPORT(0x5F6030, "kernel32.dll", "GlobalAlloc");
		FIX_IMPORT(0x5F6034, "kernel32.dll", "GlobalUnlock");
		FIX_IMPORT(0x5F6038, "kernel32.dll", "GlobalLock");
		FIX_IMPORT(0x5F603C, "kernel32.dll", "RaiseException");
		FIX_IMPORT(0x5F6040, "kernel32.dll", "GetCurrentProcess");
		FIX_IMPORT(0x5F6044, "kernel32.dll", "SetPriorityClass");
		FIX_IMPORT(0x5F6048, "kernel32.dll", "GetPriorityClass");
		FIX_IMPORT(0x5F604C, "kernel32.dll", "VirtualAlloc");
		FIX_IMPORT(0x5F6050, "kernel32.dll", "VirtualFree");
		FIX_IMPORT(0x5F6054, "kernel32.dll", "VirtualQuery");
		FIX_IMPORT(0x5F6058, "kernel32.dll", "HeapCreate");
		FIX_IMPORT(0x5F605C, "kernel32.dll", "HeapAlloc");
		FIX_IMPORT(0x5F6060, "kernel32.dll", "HeapReAlloc");
		FIX_IMPORT(0x5F6064, "kernel32.dll", "HeapFree");
		FIX_IMPORT(0x5F6068, "kernel32.dll", "Sleep");
		FIX_IMPORT(0x5F606C, "kernel32.dll", "GetCurrentProcessId");
		FIX_IMPORT(0x5F6070, "kernel32.dll", "GetCurrentThreadId");
		FIX_IMPORT(0x5F6074, "kernel32.dll", "OpenThread");
		FIX_IMPORT(0x5F6078, "kernel32.dll", "SuspendThread");
		FIX_IMPORT(0x5F607C, "kernel32.dll", "ResumeThread");
		FIX_IMPORT(0x5F6080, "kernel32.dll", "GetThreadContext");
		FIX_IMPORT(0x5F6084, "kernel32.dll", "SetThreadContext");
		FIX_IMPORT(0x5F6088, "kernel32.dll", "FlushInstructionCache");
		FIX_IMPORT(0x5F608C, "kernel32.dll", "VirtualProtect");
		FIX_IMPORT(0x5F6090, "kernel32.dll", "CloseHandle");
		FIX_IMPORT(0x5F6094, "kernel32.dll", "CreateToolhelp32Snapshot");
		FIX_IMPORT(0x5F6098, "kernel32.dll", "Thread32First");
		FIX_IMPORT(0x5F609C, "kernel32.dll", "Thread32Next");
		FIX_IMPORT(0x5F60A0, "kernel32.dll", "MultiByteToWideChar");
		FIX_IMPORT(0x5F60A4, "kernel32.dll", "InitializeCriticalSection");
		FIX_IMPORT(0x5F60A8, "kernel32.dll", "EnterCriticalSection");
		FIX_IMPORT(0x5F60AC, "kernel32.dll", "LeaveCriticalSection");
		FIX_IMPORT(0x5F60B0, "kernel32.dll", "DeleteCriticalSection");
		FIX_IMPORT(0x5F60B4, "kernel32.dll", "ReleaseSemaphore");
		FIX_IMPORT(0x5F60B8, "kernel32.dll", "WaitForSingleObject");
		FIX_IMPORT(0x5F60BC, "kernel32.dll", "CreateSemaphoreA");
		FIX_IMPORT(0x5F60C0, "kernel32.dll", "InitOnceInitialize");
		FIX_IMPORT(0x5F60C4, "kernel32.dll", "ReleaseSRWLockExclusive");
		FIX_IMPORT(0x5F60C8, "kernel32.dll", "ReleaseSRWLockShared");
		FIX_IMPORT(0x5F60CC, "kernel32.dll", "AcquireSRWLockExclusive");
		FIX_IMPORT(0x5F60D0, "kernel32.dll", "AcquireSRWLockShared");
		FIX_IMPORT(0x5F60D4, "kernel32.dll", "CreateThread");
		FIX_IMPORT(0x5F60D8, "kernel32.dll", "SetThreadPriority");
		FIX_IMPORT(0x5F60DC, "kernel32.dll", "ResetEvent");
		FIX_IMPORT(0x5F60E0, "kernel32.dll", "SetEvent");
		FIX_IMPORT(0x5F60E4, "kernel32.dll", "WriteFile");
		FIX_IMPORT(0x5F60E8, "kernel32.dll", "CreateFileA");
		FIX_IMPORT(0x5F60EC, "kernel32.dll", "WideCharToMultiByte");
		FIX_IMPORT(0x5F60F0, "kernel32.dll", "GetProcAddress");
		FIX_IMPORT(0x5F60F4, "kernel32.dll", "GetModuleHandleA");
		FIX_IMPORT(0x5F60F8, "kernel32.dll", "FindNextFileA");
		FIX_IMPORT(0x5F60FC, "kernel32.dll", "FindFirstFileA");
		FIX_IMPORT(0x5F6100, "kernel32.dll", "FindClose");
		FIX_IMPORT(0x5F6104, "kernel32.dll", "CreateDirectoryW");
		FIX_IMPORT(0x5F6108, "kernel32.dll", "WriteConsoleW");
		FIX_IMPORT(0x5F610C, "kernel32.dll", "SetStdHandle");
		FIX_IMPORT(0x5F6110, "kernel32.dll", "CreatePipe");
		FIX_IMPORT(0x5F6114, "kernel32.dll", "GetExitCodeProcess");
		FIX_IMPORT(0x5F6118, "kernel32.dll", "GetModuleHandleW");
		FIX_IMPORT(0x5F611C, "kernel32.dll", "CreateDirectoryA");
		FIX_IMPORT(0x5F6120, "kernel32.dll", "HeapSize");
		FIX_IMPORT(0x5F6124, "kernel32.dll", "GetProcessHeap");
		FIX_IMPORT(0x5F6128, "kernel32.dll", "FreeEnvironmentStringsW");
		FIX_IMPORT(0x5F612C, "kernel32.dll", "GetEnvironmentStringsW");
		FIX_IMPORT(0x5F6130, "kernel32.dll", "GetCommandLineW");
		FIX_IMPORT(0x5F6134, "kernel32.dll", "GetCommandLineA");
		FIX_IMPORT(0x5F6138, "kernel32.dll", "GetOEMCP");
		FIX_IMPORT(0x5F613C, "kernel32.dll", "GetACP");
		FIX_IMPORT(0x5F6140, "kernel32.dll", "IsValidCodePage");
		FIX_IMPORT(0x5F6144, "kernel32.dll", "GetTimeZoneInformation");
		FIX_IMPORT(0x5F6148, "kernel32.dll", "ReadConsoleW");
		FIX_IMPORT(0x5F614C, "kernel32.dll", "GetFileSizeEx");
		FIX_IMPORT(0x5F6150, "kernel32.dll", "GetConsoleMode");
		FIX_IMPORT(0x5F6154, "kernel32.dll", "GetConsoleOutputCP");
		FIX_IMPORT(0x5F6158, "kernel32.dll", "FlushFileBuffers");
		FIX_IMPORT(0x5F615C, "kernel32.dll", "EnumSystemLocalesW");
		FIX_IMPORT(0x5F6160, "kernel32.dll", "GetUserDefaultLCID");
		FIX_IMPORT(0x5F6164, "kernel32.dll", "IsValidLocale");
		FIX_IMPORT(0x5F6168, "kernel32.dll", "GetLocaleInfoW");
		FIX_IMPORT(0x5F616C, "kernel32.dll", "LCMapStringW");
		FIX_IMPORT(0x5F6170, "kernel32.dll", "CompareStringW");
		FIX_IMPORT(0x5F6174, "kernel32.dll", "GetTimeFormatW");
		FIX_IMPORT(0x5F6178, "kernel32.dll", "GetDateFormatW");
		FIX_IMPORT(0x5F617C, "kernel32.dll", "GetFileType");
		FIX_IMPORT(0x5F6180, "kernel32.dll", "GetStdHandle");
		FIX_IMPORT(0x5F6184, "kernel32.dll", "CreateProcessW");
		FIX_IMPORT(0x5F6188, "kernel32.dll", "DuplicateHandle");
		FIX_IMPORT(0x5F618C, "kernel32.dll", "GetModuleFileNameW");
		FIX_IMPORT(0x5F6190, "kernel32.dll", "ExitProcess");
		FIX_IMPORT(0x5F6194, "kernel32.dll", "DeleteFileW");
		FIX_IMPORT(0x5F6198, "kernel32.dll", "SetEnvironmentVariableW");
		FIX_IMPORT(0x5F619C, "kernel32.dll", "GetDriveTypeW");
		FIX_IMPORT(0x5F61A0, "kernel32.dll", "FormatMessageA");
		FIX_IMPORT(0x5F61A4, "kernel32.dll", "LocalFree");
		FIX_IMPORT(0x5F61A8, "kernel32.dll", "GetLocaleInfoEx");
		FIX_IMPORT(0x5F61AC, "kernel32.dll", "GetCurrentDirectoryW");
		FIX_IMPORT(0x5F61B0, "kernel32.dll", "CreateFileW");
		FIX_IMPORT(0x5F61B4, "kernel32.dll", "FindFirstFileW");
		FIX_IMPORT(0x5F61B8, "kernel32.dll", "FindFirstFileExW");
		FIX_IMPORT(0x5F61BC, "kernel32.dll", "FindNextFileW");
		FIX_IMPORT(0x5F61C0, "kernel32.dll", "GetFileAttributesExW");
		FIX_IMPORT(0x5F61C4, "kernel32.dll", "GetFullPathNameW");
		FIX_IMPORT(0x5F61C8, "kernel32.dll", "SetEndOfFile");
		FIX_IMPORT(0x5F61CC, "kernel32.dll", "SetFilePointerEx");
		FIX_IMPORT(0x5F61D0, "kernel32.dll", "GetTempPathW");
		FIX_IMPORT(0x5F61D4, "kernel32.dll", "AreFileApisANSI");
		FIX_IMPORT(0x5F61D8, "kernel32.dll", "GetLastError");
		FIX_IMPORT(0x5F61DC, "kernel32.dll", "MoveFileExW");
		FIX_IMPORT(0x5F61E0, "kernel32.dll", "GetFileInformationByHandleEx");
		FIX_IMPORT(0x5F61E4, "kernel32.dll", "QueryPerformanceCounter");
		FIX_IMPORT(0x5F61E8, "kernel32.dll", "QueryPerformanceFrequency");
		FIX_IMPORT(0x5F61EC, "kernel32.dll", "WaitForSingleObjectEx");
		FIX_IMPORT(0x5F61F0, "kernel32.dll", "GetExitCodeThread");
		FIX_IMPORT(0x5F61F4, "kernel32.dll", "GetNativeSystemInfo");
		FIX_IMPORT(0x5F61F8, "kernel32.dll", "InitializeCriticalSectionEx");
		FIX_IMPORT(0x5F61FC, "kernel32.dll", "EncodePointer");
		FIX_IMPORT(0x5F6200, "kernel32.dll", "DecodePointer");
		FIX_IMPORT(0x5F6204, "kernel32.dll", "LCMapStringEx");
		FIX_IMPORT(0x5F6208, "kernel32.dll", "InitOnceInitialize");
		FIX_IMPORT(0x5F620C, "kernel32.dll", "WakeConditionVariable");
		FIX_IMPORT(0x5F6210, "kernel32.dll", "WakeAllConditionVariable");
		FIX_IMPORT(0x5F6214, "kernel32.dll", "SleepConditionVariableCS");
		FIX_IMPORT(0x5F6218, "kernel32.dll", "SleepConditionVariableSRW");
		FIX_IMPORT(0x5F621C, "kernel32.dll", "GetSystemTimeAsFileTime");
		FIX_IMPORT(0x5F6220, "kernel32.dll", "TryEnterCriticalSection");
		FIX_IMPORT(0x5F6224, "kernel32.dll", "GetStringTypeW");
		FIX_IMPORT(0x5F6228, "kernel32.dll", "GetCPInfo");
		FIX_IMPORT(0x5F622C, "kernel32.dll", "InitializeSListHead");
		FIX_IMPORT(0x5F6230, "kernel32.dll", "UnhandledExceptionFilter");
		FIX_IMPORT(0x5F6234, "kernel32.dll", "SetUnhandledExceptionFilter");
		FIX_IMPORT(0x5F6238, "kernel32.dll", "TerminateProcess");
		FIX_IMPORT(0x5F623C, "kernel32.dll", "IsProcessorFeaturePresent");
		FIX_IMPORT(0x5F6240, "kernel32.dll", "IsDebuggerPresent");
		FIX_IMPORT(0x5F6244, "kernel32.dll", "GetStartupInfoW");
		FIX_IMPORT(0x5F6248, "kernel32.dll", "SetLastError");
		FIX_IMPORT(0x5F624C, "kernel32.dll", "FreeLibrary");
		FIX_IMPORT(0x5F6250, "kernel32.dll", "GetModuleFileNameA");
		FIX_IMPORT(0x5F6254, "kernel32.dll", "GetModuleHandleExA");
		FIX_IMPORT(0x5F6258, "kernel32.dll", "LoadLibraryA");
		FIX_IMPORT(0x5F625C, "kernel32.dll", "RtlUnwind");
		FIX_IMPORT(0x5F6260, "kernel32.dll", "InterlockedPushEntrySList");
		FIX_IMPORT(0x5F6264, "kernel32.dll", "InterlockedFlushSList");
		FIX_IMPORT(0x5F6268, "kernel32.dll", "InitializeCriticalSectionAndSpinCount");
		FIX_IMPORT(0x5F626C, "kernel32.dll", "TlsAlloc");
		FIX_IMPORT(0x5F6270, "kernel32.dll", "TlsGetValue");
		FIX_IMPORT(0x5F6274, "kernel32.dll", "TlsSetValue");
		FIX_IMPORT(0x5F6278, "kernel32.dll", "TlsFree");
		FIX_IMPORT(0x5F627C, "kernel32.dll", "LoadLibraryExW");
		FIX_IMPORT(0x5F6280, "kernel32.dll", "ReadFile");
		FIX_IMPORT(0x5F6284, "kernel32.dll", "ExitThread");
		FIX_IMPORT(0x5F6288, "kernel32.dll", "FreeLibraryAndExitThread");
		FIX_IMPORT(0x5F628C, "kernel32.dll", "GetModuleHandleExW");
		FIX_IMPORT(0x5F6290, "kernel32.dll", "CreateEventW");
		FIX_IMPORT(0x5F6298, "shell32.dll", "SHParseDisplayName");
		FIX_IMPORT(0x5F629C, "shell32.dll", "SHOpenFolderAndSelectItems");
		FIX_IMPORT(0x5F62A0, "shell32.dll", "SHGetFolderPathA");
		FIX_IMPORT(0x5F62A8, "user32.dll", "EmptyClipboard");
		FIX_IMPORT(0x5F62AC, "user32.dll", "GetKeyNameTextA");
		FIX_IMPORT(0x5F62B0, "user32.dll", "MapVirtualKeyA");
		FIX_IMPORT(0x5F62B4, "user32.dll", "SetCursor");
		FIX_IMPORT(0x5F62B8, "user32.dll", "SetClipboardData");
		FIX_IMPORT(0x5F62BC, "user32.dll", "GetAsyncKeyState");
		FIX_IMPORT(0x5F62C0, "user32.dll", "GetFocus");
		FIX_IMPORT(0x5F62C4, "user32.dll", "CallWindowProcA");
		FIX_IMPORT(0x5F62C8, "user32.dll", "SetWindowLongA");
		FIX_IMPORT(0x5F62CC, "user32.dll", "LoadCursorA");
		FIX_IMPORT(0x5F62D0, "user32.dll", "IsClipboardFormatAvailable");
		FIX_IMPORT(0x5F62D4, "user32.dll", "GetKeyState");
		FIX_IMPORT(0x5F62D8, "user32.dll", "OpenClipboard");
		FIX_IMPORT(0x5F62DC, "user32.dll", "CloseClipboard");
		FIX_IMPORT(0x5F62E0, "user32.dll", "GetClipboardData");
		FIX_IMPORT(0x5F62E8, "winmm.dll", "PlaySoundA");
		FIX_IMPORT(0x5F62F0, "wsock32.dll", "select");
		FIX_IMPORT(0x5F62F4, "wsock32.dll", "__WSAFDIsSet");
		FIX_IMPORT(0x5F62F8, "wsock32.dll", "closesocket");
		FIX_IMPORT(0x5F6318, "wsock32.dll", "socket");
		FIX_IMPORT(0x5F6300, "wsock32.dll", "send");
		FIX_IMPORT(0x5F6304, "wsock32.dll", "WSAStartup");
		FIX_IMPORT(0x5F6308, "wsock32.dll", "WSAGetLastError");
		FIX_IMPORT(0x5F630C, "wsock32.dll", "connect");
		FIX_IMPORT(0x5F6310, "wsock32.dll", "ioctlsocket");
		FIX_IMPORT(0x5F6314, "ws2_32.dll", "setsockopt");	
		FIX_IMPORT(0x5F631C, "ws2_32.dll", "FreeAddrInfoW");
		FIX_IMPORT(0x5F6320, "ws2_32.dll", "getaddrinfo");
		FIX_IMPORT(0x5F62FC, "ws2_32.dll", "recv");
	}
}